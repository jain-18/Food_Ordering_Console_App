package com.foodapp.beforeLoginMenu;

import java.util.Scanner;

import com.foodapp.AfterLogin.customer.CustomerMenu;
import com.foodapp.DBOperation.DataBaseOperation;
import com.foodapp.DBOperation.UserDAO;
import com.foodapp.Service.InputUtil;
import com.foodapp.Validation.Validation;
import com.foodapp.entity.User;

public class LoginCustomer {
	
	private final UserDAO userDao = new UserDAO();
	 private final OrderService orderService = new OrderService();
	
	Scanner scanner;
	public LoginCustomer(Scanner scanner) {
		this.scanner = scanner;
	}
	public void loginUser() {
		scanner.nextLine();
		System.out.println("\n-------Login as Customer--------");
		Validation validate = new Validation(scanner);
		String email = validate.inputEmailForLogin();
		String password = validate.inputPassword();
		
		if(DataBaseOperation.validateUser(email,password)) {
			int userId = DataBaseOperation.userId(email,password);
			CustomerMenu customerMenu = new CustomerMenu(scanner);
			customerMenu.customerMenu(userId);
		}else {
			System.out.println("Invalid Credentials");
		}
	}
	
	public void login() {
        System.out.println("\n--- User Login ---");
        String input = InputUtil.getString("Enter email or mobile: ");
        String password = InputUtil.getString("Enter password: ");

        User user = userDao.findByEmailOrMobile(input, password);
        if (user != null) {
            System.out.println("Login successful. Welcome " + user.getFirstName() + "!");
            orderService.orderMenu(user);
        } else {
            System.out.println("Invalid credentials.");
        }
    }
	

}
